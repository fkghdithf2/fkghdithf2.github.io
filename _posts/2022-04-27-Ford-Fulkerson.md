---
layout: post
title:  "Ford-Fulkerson"
date:   2022-04-27 20:12:04 +0900
categories: jekyll update
---
# 네트워크 유량 문제

원래의 그래프는 간선을 거리, 비용으로 생각했다면, 유량 네트워크 (Flow Network)에서는 단방향 그래프에서 간선의 가중치를 최대로 흐를 수 있는 용량(capacity)과 실제로 흐르는 유량(flow)으로 생각한다. 이게 무슨 말이냐 하면 A에서 B로 가중치가 10이 존재한다면, A에서 B로 흐를 수 있는 최대 물의 양이 10이라고 해석할 수 있다. (실제로 물이 얼마나 흐르는지는 우리가 얼마나 흘려보내냐에 따라 다르다.)
이제 유량 네트워크가 뭔지 대충 느낌을 알았는데, 그래서 네트워크 유량이 뭐냐? 하면 네트워크 유량은 이 유량 네트워크에서 최대로 물이 얼마나 흐를 수 있는가?를 구하는 문제이다. 이때 흐를 수 있는 물의 양을 최대 유량(Max Flow)이라고 한다. (아까부터 물이라고 했는데, 물, 데이터, 기름 등 뭐든지 흐를 수 있는 것이면 된다. 일반적으로 통틀어서 그냥 "유량이 흐른다"라고 표현한다.) 
또한 네트워크 유량 문제는 "어디에서 어디로 최대 얼마만큼의 유량이 흐를 수 있는가?"라는 문제이므로 "어디에서"와 "어디로"가 중요한데, "어디에서"를 source라고 하고 "어디로"를 sink라고 한다. 위 그림에서는 A가 source, B가 sink이다. 그런데 source, sink 모두 용어가 s로 시작하므로 보통 source를 $s$로, sink를 $t$로 표기한다.


# 포드 풀커슨 알고리즘 <br>(Ford-Fulkerson Algorithm)
포드 풀커슨 알고리즘은 최대 유량을 구하는 알고리즘이다. 알고리즘이 아니라 방법론(Method)라고 부르기도 하는데, 이는 뒷부분에서 언급하겠다.
<br>
residual capacity (잔여 용량, 남은 용량) :  $c_f(u, v) = c(u, v) - f(u, v)$

정점 u에서 정점 v로의 잔여 용량은 최대 용량에서 실제 흐르는 양을 뺀 것이라는 의미이다. 위의 그림에서는 용량이 10, 유량이 7이라고 했으므로 잔여 용량 = 용량 - 유량 = 10 - 7 = 3만큼의 유량이 더 흐를 수 있다.

 

skew-symmetricity (반대칭성) : $f(u, v) = -f(v, u)$

반대칭성은 아까 그림에서 A->B에서 7의 유량이 흐른다면, B->A로는 -7의 유량이 흐를 수 있다는 것을 의미한다. 유량이 음수인 게 무슨 개소리냐? 고 할 수 있겠지만 이게 포드 풀커슨의 킬링 포인트인데, 반대칭성의 정의를 이용하면 B->A로의 잔여 용량은 $c_f(B, A) = c(B, A) - f(B, A) = 0 - f(B, A) = f(A, B) = 7$ 식을 정리하면 $c_f(B, A) = f(A, B)$이다. 정리된 식을 해석하면 B->A 방향으로는 A->B방향으로 흘러 보낸 만큼 다시 되돌릴 수 있다. *다시 말해, 이미 유량을 흘려보냈던 행위를 취소할 수 있다.

 

residual network (잔여 네트워크) :

잔여 용량을 가중치로 갖는 그래프를 의미한다. 위의 그림을 예시로 들면 A->B로의 잔여 용량은 3이다. A에서 B로 3만큼의 유량을 흘려보낼 수 있다. 또한 B->A로의 잔여 용량은 7이다. 따라서 7만큼의 유량을 되돌려 보낼 수 있다. 가중치가 이렇게 잔여 용량으로 이루어져 있다.

# 포드 풀커슨 알고리즘을 완성하기 위한 성질들

capacity constraint (용량 제한) : $0 \geq f(u, v) \leq c(u, v)$ (유량은 0 이상 용량 이하) 

flow conservation (유량 보존) : source, sink를 제외한 모든 정점에서는 들어오는 유량과 나가는 유량이 같다
<br>

# 포드 풀커슨 알고리즘의 진행 과정

자, 아직 이 알고리즘이 어떻게 동작하는지도 모르는데 벌써 많은 개념을 배웠다. 이제 진행 과정을 살펴보자 크게 두 단계로 나뉜다.

 

1. BFS or DFS로 잔여 네트워크에서의 source에서 sink로의 경로를 찾는다 (이를 augumenting path라고 한다. 추후에 다시 설명하겠다.) (단, u->v로의  잔여 용량이 0 이상인 경우에만 경로가 만들어질 수 있다.) 당연한 말이지만 이미 파이프가 꽉 차면 더 이상의 유량을 흘려보낼 수 없다.

2. 앞에서 찾은 경로를 이루는 간선 중 잔여 용량이 가장 작은 것을 찾는다.

3. 2에서 찾은 것을 전체 유량에 더해준다

4. 1~3을 다시 반복

 

이 과정을 통해서 구한 유량의 총합이 최대 유량이 된다.

 

그런데 아마 저 세줄로 이 알고리즘을 이해하긴 어려울 것이다. 그러므로 예시를 살펴보자. 



---